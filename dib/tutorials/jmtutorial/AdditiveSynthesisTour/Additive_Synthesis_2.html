<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/tutorial files.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" -->
<title>Digital Instrument Building</title>
<!-- InstanceEndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="DC.Creator" CONTENT="PersonalName= Andrew R. Brown  ">
<META NAME="DC.Creator.Email" CONTENT="algorithmicmusic@gmail.com,">
<META NAME="DC.Rights" CONTENT="Andrew R. Brown ">
<META NAME="DC.Title" CONTENT="Digital Instrument Building - Music software development with jMusic">
<META NAME="DC.Title.Alternative" content ="Music software development with jMusic">
<META NAME="DC.Subject" CONTENT="music, java, composition, algorithmic, digital music, generative music, instrument building, music analysing software development, Australia">
<META NAME="DC.Description" CONTENT="This site is a tutorial resource designed to assist in the training and self education of up-and-coming digital instrument developers. The tutorials cover topics including music software design, audio synthesis, digital signal processing, compositional systems, and computer programming concepts. ">
<META NAME="DC.Language" SCHEME="rfc1766" CONTENT="en-au">
<META NAME="DC.Audience" CONTENT="All">
<META NAME="DC.Date.Created" CONTENT="06-04-2003">
<META NAME="DC.Availability" CONTENT="PersonalName= Andrew R. Brown; email= algorithmicmusic@gmail.com">
<!-- ImageReady Preload Script (menubanner2.psd) -->
<SCRIPT TYPE="text/javascript">
<!--

function newImage(arg) {
	if (document.images) {
		rslt = new Image();
		rslt.src = arg;
		return rslt;
	}
}

function changeImages() {
	if (document.images && (preloadFlag == true)) {
		for (var i=0; i<changeImages.arguments.length; i+=2) {
			document[changeImages.arguments[i]].src = changeImages.arguments[i+1];
		}
	}
}

var preloadFlag = false;
function preloadImages() {
	if (document.images) {
		Music_algorithms_over = newImage("images/Music-algorithms-over.jpg");
		Interfaces_over = newImage("images/Interfaces-over.jpg");
		Programming_over = newImage("images/Programming-over.jpg");
		Acoustics_over = newImage("images/Acoustics-over.jpg");
		context_over = newImage("images/context-over.jpg");
		audio_over = newImage("images/audio-over.jpg");
		MIDI_over = newImage("images/MIDI-over.jpg");
		preloadFlag = true;
	}
}

// -->
</SCRIPT>
<!-- End Preload Script -->
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
//-->
</script>
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);

function MM_nbGroup(event, grpName) { //v6.0
  var i,img,nbArr,args=MM_nbGroup.arguments;
  if (event == "init" && args.length > 2) {
    if ((img = MM_findObj(args[2])) != null && !img.MM_init) {
      img.MM_init = true; img.MM_up = args[3]; img.MM_dn = img.src;
      if ((nbArr = document[grpName]) == null) nbArr = document[grpName] = new Array();
      nbArr[nbArr.length] = img;
      for (i=4; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
        if (!img.MM_up) img.MM_up = img.src;
        img.src = img.MM_dn = args[i+1];
        nbArr[nbArr.length] = img;
    } }
  } else if (event == "over") {
    document.MM_nbOver = nbArr = new Array();
    for (i=1; i < args.length-1; i+=3) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = (img.MM_dn && args[i+2]) ? args[i+2] : ((args[i+1])? args[i+1] : img.MM_up);
      nbArr[nbArr.length] = img;
    }
  } else if (event == "out" ) {
    for (i=0; i < document.MM_nbOver.length; i++) {
      img = document.MM_nbOver[i]; img.src = (img.MM_dn) ? img.MM_dn : img.MM_up; }
  } else if (event == "down") {
    nbArr = document[grpName];
    if (nbArr)
      for (i=0; i < nbArr.length; i++) { img=nbArr[i]; img.src = img.MM_up; img.MM_dn = 0; }
    document[grpName] = nbArr = new Array();
    for (i=2; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = img.MM_dn = (args[i+1])? args[i+1] : img.MM_up;
      nbArr[nbArr.length] = img;
  } }
}
//-->
</script>
<link href="../../../style/main.css" rel="stylesheet" type="text/css">
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
</head>
<body leftmargin="3" topmargin="3" marginwidth="0" marginheight="0"  onLoad="MM_preloadImages('../../../images/banner/audio-over.jpg','../../../images/banner/MIDI-over.jpg','../../../images/banner/Music-algorithms-over.jpg','../../../images/banner/Interfaces-over.jpg','../../../images/banner/Programming-over.jpg','../../../images/banner/Acoustics-over.jpg','../../../images/banner/context-over.jpg','../../../images/banner/banner_08.gif')">
<table width="691" border="0" align="center">
  <tr> 
    <td colspan="5" align="left"> <div align="center"> 
        <table border="0" align="left" cellpadding="0" cellspacing="0">
          <tr> 
            <td colspan="8"><img src="../../../images/banner.jpg" alt="" width=758 height=57 border="0" usemap="#Map5"></td>
          </tr>
          <tr> 
            <td width="50"><a href="../../../Audio/audio.htm" target="_top" onClick="MM_nbGroup('down','group1','Audio','../../../images/banner/audio-over.jpg',1)" onMouseOver="MM_nbGroup('over','Audio','../../../images/banner/audio-over.jpg','../../../images/banner/audio-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/audio.jpg" alt="audio" name="Audio" width="50" height="24" border="0" onload=""></a></td>
            <td width="47"><a href="../../../midi/midi.htm" target="_top" onClick="MM_nbGroup('down','group1','MIDI','../../../images/banner/MIDI-over.jpg',1)" onMouseOver="MM_nbGroup('over','MIDI','../../../images/banner/MIDI-over.jpg','../../../images/banner/MIDI-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/MIDI.jpg" alt="MIDI" name="MIDI" width="47" height="24" border="0" onload=""></a></td>
            <td width="117"><a href="../../../musalgo/musalgo.htm" target="_top" onClick="MM_nbGroup('down','group1','musalgorithms','../../../images/banner/Music-algorithms-over.jpg',1)" onMouseOver="MM_nbGroup('over','musalgorithms','../../../images/banner/Music-algorithms-over.jpg','../../../images/banner/Music-algorithms-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/Music-algorithms.jpg" alt="Music Algorithms" name="musalgorithms" width="117" height="24" border="0" onload=""></a></td>
            <td width="88"><a href="../../../interfaces/interface.htm" target="_top" onClick="MM_nbGroup('down','group1','Interfaces','../../../images/banner/Interfaces-over.jpg',1)" onMouseOver="MM_nbGroup('over','Interfaces','../../../images/banner/Interfaces-over.jpg','../../../images/banner/Interfaces-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/Interfaces.jpg" alt="Interfaces" name="Interfaces" width="88" height="24" border="0" onload=""></a></td>
            <td width="103"><a href="../../../programming/programming.htm" target="_top" onClick="MM_nbGroup('down','group1','Programming','../../../images/banner/Programming-over.jpg',1)" onMouseOver="MM_nbGroup('over','Programming','../../../images/banner/Programming-over.jpg','../../../images/banner/Programming-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/Programming.jpg" alt="Programming" name="Programming" width="103" height="24" border="0" onload=""></a></td>
            <td width="81"><a href="../../../acoustics/acoustics.htm" target="_top" onClick="MM_nbGroup('down','group1','Acoustics','../../../images/banner/Acoustics-over.jpg',1)" onMouseOver="MM_nbGroup('over','Acoustics','../../../images/banner/Acoustics-over.jpg','../../../images/banner/Acoustics-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/Acoustics.jpg" alt="Acoustics" name="Acoustics" width="81" height="24" border="0" onload=""></a></td>
            <td width="100"><a href="../../../context/context.htm" target="_top" onClick="MM_nbGroup('down','group1','Context','../../../images/banner/context-over.jpg',1)" onMouseOver="MM_nbGroup('over','Context','../../../images/banner/context-over.jpg','../../../images/banner/context-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../../images/banner/context.jpg" alt="Context" name="Context" width="100" height="24" border="0" onload=""></a></td>
            <td width="156"><img src="../../../images/banner/banner_09.gif" width="172" height="24"></td>
          </tr>
        </table>
      </div></td>
  </tr>
  <tr> 
    <td width="3" align="left"> <div align="right"></div>
      <div align="right"></div>
      <div align="right"></div></td>
    <!-- InstanceBeginEditable name="tracker" -->
    <td height="16" colspan="2" rowspan="2" align="left"><a href="../../../Audio/audio.htm">&gt; 
      Audio</a> &gt; <a href="../../../Audio/synthesis.htm">Synthesis</a> &gt; 
      <a href="Additive_Synthesis_2.html">Additive Synthesis</a></td>
    <!-- InstanceEndEditable -->
    <td width="15" rowspan="2" align="left">&nbsp;</td>
    <td width="214" rowspan="2" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="3" rowspan="3" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="66" align="left" valign="top">&nbsp;</td>
    <td width="444" align="left" valign="top">&nbsp;</td>
    <td colspan="2" align="left" valign="top"><strong></strong></td>
  </tr>
  <tr> <!-- InstanceBeginEditable name="content" --> 
    <td colspan="4" rowspan="3" align="left" valign="top"> <h2 class="c3">Additive 
        Synthesis</h2>
      <p class="c3">jMusic can be used to create instruments with all manner of 
        synthesis systems. <br>
        One of the easiest to understand is additive synthesis, where multiple 
        sine waves of different frequencies are summed.<br>
      </p>
      <p class="c3"><img src="additiveSynthDiagram.gif" alt="Additive Synthesis "
 width="260" height="291"
 align="bottom" x-sas-useimagewidth="" x-sas-useimageheight=""></p>
      <p class="c3">The final Audio file will sound like this: <a
 href="../soundExamples/AddSynthTest.au">AddSynthTest.au [1774kb ]</a></p>
      <p class="c3"></p>
      <p class="c6"><a class="c5" href="../../inst/AddSynthInst.java"
 target="_top">Click here to view source for AddSynthInt.java<br>
        </a></p>
      <p class="c3">Lets have a closer look<br>
      </p>
      <p class="c3">There is a constructor that just takes the sampleRate and 
        provides defaults for all other settings. This provides a tone similar 
        to the one in the audio example above. To use it create an instrument 
        like this:<br>
      </p>
      <p class="c3"><span class="c7">Instrument inst = new AddSynthInst(44100);</span><br>
      </p>
      <p class="c3">Next, let's look at the constructor which sets up all the 
        variables such as frequencies and amplitudes.</p>
      <b><br>
        </b> &#160;
      <table border="0" width="100%" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td> <pre>	public AddSynthInst(int sampleRate, float[] overtoneRatios,<br>                            float[] overtoneVolumes, double[][] envPointArray){<br><br>        	this.overtoneRatios = overtoneRatios;<br>               	this.overtoneVolumes = overtoneVolumes;<br><br>        	double[][] tempPoints = new double[envPointArray.length][];<br><br>        	for (int i=0; i&lt;envPointArray.length; i++) {<br>                     tempPoints[i] = envPoints;<br>          	}<br>           	allEnvPoints = tempPoints;<br>         <br>            	this.sampleRate = sampleRate;<br>       	}<br><br>
            </pre> 
            </td>
          </tr>
        </tbody>
      </table>
        
      <span class="c8">The constructor above takes a series of arrays for the 
      frequency, volume and envelope of each harmonic. Make sure when using this 
      constructor that the number of values in each array match (i.e., five values 
      in each array if you want five harmonics).<br>
      </span> <br> <br> <p class="c3"><br>
        The audio object organisation shown in the flow chart above is depicted 
        in jMusic code below, taken from the AddSynthInst class. This shows the 
        inner workings of the class. The for loop allows the instrument to support 
        any number of overtones, specified by the number of elements in the arrays 
        passed to the constructor.</p>
      <table border="0" width="100%" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td> <pre>	public void createChain(){<br>      		Envelope[] env = new Envelope[overtoneRatios.length];<br>               	Volume[] vol = new Volume[overtoneRatios.length];<br>           	Oscillator[] osc = new Oscillator[overtoneRatios.length];<br>        <br>	   	for(int i=0;i&lt;overtoneRatios.length;i++){<br>                	osc[i] = new Oscillator(this, Oscillator.SINE_WAVE,<br>                            			this.sampleRate,2);<br>                     	osc[i].setFrqRatio(overtoneRatios[i]);<br>                      	env[i] = new Envelope(osc[i], allEnvPoints[i]);<br>                     	vol[i] = new Volume(env[i], overtoneVolumes[i]);<br>            	}<br><br>               	Add add = new Add(vol);<br>                StereoPan span = new StereoPan(add);<br>             	SampleOut sout = new SampleOut(span);<br>       	}<br></pre> 
            </td>
          </tr>
        </tbody>
      </table>
      <span class="c8"><br>
      </span> <br> <br> <hr width="100%" size="2"> <p class="c3">Now let's look 
        at a class that uses the additive synthesis instrument.</p>
      <p class="c6"><a class="c5" href="../../jmdemos/AddSynthTest.java"
 target="_top">Click here to view source.</a></p>
      <table border="0" width="100%" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td> <pre>import jm.JMC;<br>import jm.util.*;<br>import jm.music.data.*;<br>import jm.midi.*;<br><br>import jm.audio.synth.*;<br>import jm.audio.Instrument;<br><br>import java.io.File;<br><br><br>public final class AddSynthTest implements JMC{<br>	public static void main(String[] args){<br>        	Score s = new Score("Additive synthesis test");<br>        	Part p = new Part("Flute", 0);<br>        	Phrase  phr = new Phrase();<br> <span
 class="comment">       	//create the test note/score and display it</span><br>        	for(int i=0;i&lt;6;i++) {<br>        		Note n = new Note(A2+i*6, 0.5*(i+1));<br>        	        phr.addNote(n);	<br>		}<br>        	p.addPhrase(phr);<br>        	s.addPart(p);<br>              <br> <span
 class="comment">       	//create the instrument</span><br>        	AddSynthInst inst = new AddSynthInst(44100);<br>        	Instrument[] ensemble = {inst};<br>            <br> <span
 class="comment">       	// write out the files</span><br>        	Write.au(s, "AddSynthTest.au",ensemble);<br>        }<br>}<br>
            </pre> </td>
          </tr>
        </tbody>
      </table>
      <p>Try modifying this class to create a more interesting sound by using 
        the alternate constructor that takes arrays of values.<br>
        <br>
        All instruments in jMusic extend the Instrument class, by doing this they 
        inherit a great deal of automatic behaviour<br>
        that is useful but on no concern for us in this tutorial.<br>
      </p>
      <p>The code above creates four sine waves, each one at a higher frequency 
        - specified by the setfrqRatio() method. <br>
        Each overtone is also at a different loudness - higher frequencies are 
        at lower levels, as is common in natural sounds.<br>
      </p>
        
      <p>These harmonics are added together, passed through an amplitude envelope 
        object, panned as appropriate for the note, <br>
        then written to an audio file on disk.<br>
      </p>
        <p class="c8">Musical Example</p>
        <table border="0" width="100%" bgcolor="#e0e0e0">
          <tbody>
            <tr> 
              <td> <pre>import jm.JMC;<br>import jm.music.data.*;<br>import jm.audio.*;<br>import jm.util.*public final class HarmonicsTest implements JMC{<br>	public static void main(String[] args){<br>	       Score score = new Score("JMDemo - Additive synthesis test");<br>	       Part part = new Part("wave", 0); <br>	       Phrase phr = new Phrase(0.0);<br>	       int sampleRate = 44100;<br>	       Instrument inst = new OvertoneInst(sampleRate);<br>	       <br>	       Note note = new Note(C4, 4.0);<br>	       phr.addNote(note);<br>	       <br>	       part.addPhrase(phr);<br>	       score.addPart(part);<br>         Write.au(score, "HarmonicsTest.au", inst); <br>    }<br>}
            </pre> 
              </td>
            </tr>
          </tbody>
        </table>
        <br>
        <br>
        <p>The code above uses the instrument to render a simple jMusic score 
        that has just one note.</p>
      <p>&nbsp;</p>
        <h5>&nbsp;</h5>
      </div>
      </td>
    <!-- InstanceEndEditable --></tr>
  <tr> 
    <td align="left"> <div align="left"></div></td>
  </tr>
  <tr> 
    <td align="left">&nbsp;</td>
  </tr>
</table>
<blockquote> 
  <p name="Map"> 
    <map name="Map">
      <area shape="rect" coords="4,4,41,29" href="http://jmusic.ci.qut.edu" target="_blank" alt="jMusic">
      <area shape="rect" coords="43,5,80,31" href="http://www.ozco.gov.au" target="_blank" alt="Australia Council">
      <area shape="rect" coords="83,4,108,29" href="http://www.qut.com" target="_blank" alt="Queensland University of Technology">
    </map>
    <map name="Map2">
      <area shape="rect" coords="702,1,758,12" href="../../../extras/sitemap.html" target="_self" alt="Sitemap">
      <area shape="rect" coords="629,1,687,12" href="../../../extras/contact.html" target="_self" alt="Contact">
      <area shape="rect" coords="574,1,615,14" href="../../../index.html" target="_self" alt="Home">
    </map>
    <map name="Map3">
      <area shape="rect" coords="553,5,601,18" href="#" alt="Home">
      <area shape="rect" coords="612,4,671,18" href="#">
      <area shape="rect" coords="683,3,735,19" href="#">
      <area shape="rect" coords="9,8,227,59" href="#" target="index.html">
    </map>
    <map name="Map4">
      <area shape="rect" coords="6,9,40,41" href="http://www.qut.com" target="_blank" alt="http://www.qut.com">
      <area shape="rect" coords="44,14,87,42" href="http://explodingart.com/jmusic" target="_blank" alt="http://explodingart.com/jmusic">
      <area shape="rect" coords="90,9,138,43" href="http://www.ozco.gov.au" target="_parent" alt="http://www.ozco.gov.au">
      <area shape="rect" coords="313,13,512,36" href="../../../contact.html">
    </map>
  </p>
</blockquote>
<map name="Map5">
  <area shape="rect" coords="-7,4,228,51" href="../../../index.htm" target="_self" alt="Digital Instrument making">
  <area shape="rect" coords="599,1,658,18" href="../../../index.htm" alt="Home">
  <area shape="rect" coords="677,3,755,18" href="../../../extras/contact.htm" target="extras">
</map>
</body>
<!-- InstanceEnd --></html>
