<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/tutorial files.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" -->
<title>Digital Instrument Building</title>
<!-- InstanceEndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="DC.Creator" CONTENT="PersonalName= Andrew R. Brown  ">
<META NAME="DC.Creator.Email" CONTENT="algorithmicmusic@gmail.com,">
<META NAME="DC.Rights" CONTENT="Andrew R. Brown ">
<META NAME="DC.Title" CONTENT="Digital Instrument Building - Music software development with jMusic">
<META NAME="DC.Title.Alternative" content ="Music software development with jMusic">
<META NAME="DC.Subject" CONTENT="music, java, composition, algorithmic, digital music, generative music, instrument building, music analysing software development, Australia">
<META NAME="DC.Description" CONTENT="This site is a tutorial resource designed to assist in the training and self education of up-and-coming digital instrument developers. The tutorials cover topics including music software design, audio synthesis, digital signal processing, compositional systems, and computer programming concepts. ">
<META NAME="DC.Language" SCHEME="rfc1766" CONTENT="en-au">
<META NAME="DC.Audience" CONTENT="All">
<META NAME="DC.Date.Created" CONTENT="06-04-2003">
<META NAME="DC.Availability" CONTENT="PersonalName= Andrew R. Brown; email= algorithmicmusic@gmail.com">
<!-- ImageReady Preload Script (menubanner2.psd) -->
<SCRIPT TYPE="text/javascript">
<!--

function newImage(arg) {
	if (document.images) {
		rslt = new Image();
		rslt.src = arg;
		return rslt;
	}
}

function changeImages() {
	if (document.images && (preloadFlag == true)) {
		for (var i=0; i<changeImages.arguments.length; i+=2) {
			document[changeImages.arguments[i]].src = changeImages.arguments[i+1];
		}
	}
}

var preloadFlag = false;
function preloadImages() {
	if (document.images) {
		Music_algorithms_over = newImage("images/Music-algorithms-over.jpg");
		Interfaces_over = newImage("images/Interfaces-over.jpg");
		Programming_over = newImage("images/Programming-over.jpg");
		Acoustics_over = newImage("images/Acoustics-over.jpg");
		context_over = newImage("images/context-over.jpg");
		audio_over = newImage("images/audio-over.jpg");
		MIDI_over = newImage("images/MIDI-over.jpg");
		preloadFlag = true;
	}
}

// -->
</SCRIPT>
<!-- End Preload Script -->
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
//-->
</script>
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);

function MM_nbGroup(event, grpName) { //v6.0
  var i,img,nbArr,args=MM_nbGroup.arguments;
  if (event == "init" && args.length > 2) {
    if ((img = MM_findObj(args[2])) != null && !img.MM_init) {
      img.MM_init = true; img.MM_up = args[3]; img.MM_dn = img.src;
      if ((nbArr = document[grpName]) == null) nbArr = document[grpName] = new Array();
      nbArr[nbArr.length] = img;
      for (i=4; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
        if (!img.MM_up) img.MM_up = img.src;
        img.src = img.MM_dn = args[i+1];
        nbArr[nbArr.length] = img;
    } }
  } else if (event == "over") {
    document.MM_nbOver = nbArr = new Array();
    for (i=1; i < args.length-1; i+=3) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = (img.MM_dn && args[i+2]) ? args[i+2] : ((args[i+1])? args[i+1] : img.MM_up);
      nbArr[nbArr.length] = img;
    }
  } else if (event == "out" ) {
    for (i=0; i < document.MM_nbOver.length; i++) {
      img = document.MM_nbOver[i]; img.src = (img.MM_dn) ? img.MM_dn : img.MM_up; }
  } else if (event == "down") {
    nbArr = document[grpName];
    if (nbArr)
      for (i=0; i < nbArr.length; i++) { img=nbArr[i]; img.src = img.MM_up; img.MM_dn = 0; }
    document[grpName] = nbArr = new Array();
    for (i=2; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = img.MM_dn = (args[i+1])? args[i+1] : img.MM_up;
      nbArr[nbArr.length] = img;
  } }
}
//-->
</script>
<link href="../../style/main.css" rel="stylesheet" type="text/css">
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
</head>
<body leftmargin="3" topmargin="3" marginwidth="0" marginheight="0"  onLoad="MM_preloadImages('../../images/banner/audio-over.jpg','../../images/banner/MIDI-over.jpg','../../images/banner/Music-algorithms-over.jpg','../../images/banner/Interfaces-over.jpg','../../images/banner/Programming-over.jpg','../../images/banner/Acoustics-over.jpg','../../images/banner/context-over.jpg','../../images/banner/banner_08.gif')">
<table width="691" border="0" align="center">
  <tr> 
    <td colspan="5" align="left"> <div align="center"> 
        <table border="0" align="left" cellpadding="0" cellspacing="0">
          <tr> 
            <td colspan="8"><img src="../../images/banner.jpg" alt="" width=758 height=57 border="0" usemap="#Map5"></td>
          </tr>
          <tr> 
            <td width="50"><a href="../../Audio/audio.htm" target="_top" onClick="MM_nbGroup('down','group1','Audio','../../images/banner/audio-over.jpg',1)" onMouseOver="MM_nbGroup('over','Audio','../../images/banner/audio-over.jpg','../../images/banner/audio-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/audio.jpg" alt="audio" name="Audio" width="50" height="24" border="0" onload=""></a></td>
            <td width="47"><a href="../../midi/midi.htm" target="_top" onClick="MM_nbGroup('down','group1','MIDI','../../images/banner/MIDI-over.jpg',1)" onMouseOver="MM_nbGroup('over','MIDI','../../images/banner/MIDI-over.jpg','../../images/banner/MIDI-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/MIDI.jpg" alt="MIDI" name="MIDI" width="47" height="24" border="0" onload=""></a></td>
            <td width="117"><a href="../../musalgo/musalgo.htm" target="_top" onClick="MM_nbGroup('down','group1','musalgorithms','../../images/banner/Music-algorithms-over.jpg',1)" onMouseOver="MM_nbGroup('over','musalgorithms','../../images/banner/Music-algorithms-over.jpg','../../images/banner/Music-algorithms-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Music-algorithms.jpg" alt="Music Algorithms" name="musalgorithms" width="117" height="24" border="0" onload=""></a></td>
            <td width="88"><a href="../../interfaces/interface.htm" target="_top" onClick="MM_nbGroup('down','group1','Interfaces','../../images/banner/Interfaces-over.jpg',1)" onMouseOver="MM_nbGroup('over','Interfaces','../../images/banner/Interfaces-over.jpg','../../images/banner/Interfaces-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Interfaces.jpg" alt="Interfaces" name="Interfaces" width="88" height="24" border="0" onload=""></a></td>
            <td width="103"><a href="../../programming/programming.htm" target="_top" onClick="MM_nbGroup('down','group1','Programming','../../images/banner/Programming-over.jpg',1)" onMouseOver="MM_nbGroup('over','Programming','../../images/banner/Programming-over.jpg','../../images/banner/Programming-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Programming.jpg" alt="Programming" name="Programming" width="103" height="24" border="0" onload=""></a></td>
            <td width="81"><a href="../../acoustics/acoustics.htm" target="_top" onClick="MM_nbGroup('down','group1','Acoustics','../../images/banner/Acoustics-over.jpg',1)" onMouseOver="MM_nbGroup('over','Acoustics','../../images/banner/Acoustics-over.jpg','../../images/banner/Acoustics-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Acoustics.jpg" alt="Acoustics" name="Acoustics" width="81" height="24" border="0" onload=""></a></td>
            <td width="100"><a href="../../context/context.htm" target="_top" onClick="MM_nbGroup('down','group1','Context','../../images/banner/context-over.jpg',1)" onMouseOver="MM_nbGroup('over','Context','../../images/banner/context-over.jpg','../../images/banner/context-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/context.jpg" alt="Context" name="Context" width="100" height="24" border="0" onload=""></a></td>
            <td width="156"><img src="../../images/banner/banner_09.gif" width="172" height="24"></td>
          </tr>
        </table>
      </div></td>
  </tr>
  <tr> 
    <td width="3" align="left"> <div align="right"></div>
      <div align="right"></div>
      <div align="right"></div></td>
    <!-- InstanceBeginEditable name="tracker" -->
    <td height="16" colspan="2" rowspan="2" align="left"><a href="../../midi/midi.htm">&gt; 
      MIDI </a> &gt; <a href="../../midi/musdata.htm">Musical Data</a> &gt;<a href="Follow.html"> 
      Following Phrases</a></td>
    <!-- InstanceEndEditable -->
    <td width="15" rowspan="2" align="left">&nbsp;</td>
    <td width="214" rowspan="2" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="3" rowspan="3" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="66" align="left" valign="top">&nbsp;</td>
    <td width="444" align="left" valign="top">&nbsp;</td>
    <td colspan="2" align="left" valign="top"><strong></strong></td>
  </tr>
  <tr> <!-- InstanceBeginEditable name="content" --> 
    <td colspan="4" rowspan="3" align="left" valign="top">
      
          <h2 >Following Phrases: Repeating phrases 
            and algorithms</span></h2>
          <p>In this class you will see an example of 
            how one phrase can be repeated to create a dense texture. This is 
            not new to the tutorials, the Row Your Boat tutorial introduced cannonic 
            writing. In this tutorial that process is automated to a greater extent, 
            and the use of random elements creates a somewhat variable outcome.</span> 
          </p>
          <p>To take advantage of the variety of outcomes, 
            this class produces several versions of the score in one go. This 
            technique can save considerable time, because running this program 
            once makes several MIDI files which can then be auditioned as a batch 
            to select the most interesting one.</span></p>
          
      <p>To hear one possible result play the MIDI file below.<br>
        <embed src="soundExamples/Follow.mid" width="150" height="60"
 controller="TRUE" loop="FALSE" autoplay="FALSE"></embed><br>
        <a
 href="../jmdemos/FollowMusic.java" target="_top">Click here to view source</a><i></span></i></p>
          <p>Lets have a closer look at what just happened. 
            </span> 
          <table border="0" width="100%" bgcolor="#e0e0e0">
            <tbody>
              <tr> 
                <td> <pre>import jm.JMC;<br>import jm.music.data.*;<br>import jm.util.*; </span> <span class="comment">  <br>&nbsp;<br>/**<br>* A class that creates cannonic pulse based music, in spades.<br>* @author Benn Woods and Andrew R. Brown<br>*/ </span> <br>&nbsp;<br>public final class FollowMusic implements JMC { </span><br>&nbsp; </pre> </td>
              </tr>
            </tbody>
          </table>
          
      <br>
      The basic jm libraries used by the class are imported first. The JMC has 
      the note constants and so on. The jm/music/data directory has the jm data 
      structure classes, such as Phrase, Score, and Part. The jm/util directory 
      contains the classes used to write, read, and display the score.</span> 
      <p></p>
          <p>There is a comment to describe the class 
            and acknowledge the creators.</span></p>
          <p>The FollowMusic class declared to be public 
            (availible to all other classes) final (no subclasses of this class 
            can be made) and it implements (uses) the JMC class (to access jMusic's 
            constants).</span> </p>
          <p> 
          <table border="0" width="100%" bgcolor="#e0e0e0">
            <tbody>
              <tr> 
                <td> <pre>  <span class="comment">  			// create a phrase to hold the melody </span> <br>			Phrase phr = new Phrase(0.0);<br>			 </span> <span class="comment">  <br>			// create a random walk melody </span> <br>			int pitch = C4;<br>			for(int i=0;i&lt;60;i++){<br>				Note n = new Note(pitch,0.5, (int)(Math.random()*127));<br>				phr.addNote(n);<br>				pitch += (int)(Math.random()*10-5);<br>			}		 </span> </pre> </td>
              </tr>
            </tbody>
          </table>
          
      <br>
      This section of the code creates the melody.</span> <br>
      First an empty Phrase object is declared with the name 'phr'.<br>
      Second, a variable named 'pitch' is declared. It is of type 'int' and given 
      and initial value of C4, which is the JMC constant for 60 (middle C in MIDI 
      pitch speak).</span> 
      <p>Thirdly, a for-loop creates notes named 
            'n' and adds them to the phrase 'phr'. The note constructor is passed 
            three arguments, pitch (the variable declared earlier), 0.5 (the rhythm 
            value - we could have used QUAVER or EIGHTH_NOTE instead), and </span><span class="code">(int)(Math.random()*127)</span> which results in a random number between 0 and 126 which 
            will be the note's dynamic value.</span></p>
          <p>The phrase 'phr' calls its addNote() method 
            with the note object 'n' as an argument. This adds 'n' to the end 
            of the noteList inside 'phr'.</span></p>
          <p>Finally, the 'pitch' variable is updated 
            by adding a random number between -5 and +4 to its current value. 
            in this way the melody meanders along in intervals no larger than 
            5 semitones.</span></p>
          <p> 
          <table border="0" width="100%" bgcolor="#e0e0e0">
            <tbody>
              <tr> 
                <td> <pre>  <span class="comment">  			// copy and repeat the melody numerous times </span> <br>			for(int i=0;i&lt;9;i++){<br>				Part p = new Part("inst 1", XYLOPHONE, i);<br>				Phrase tempPhrase = new Phrase();<br>				tempPhrase = phr.copy();<br>				tempPhrase.setStartTime((double)i/4.0+i*2);<br>				p.addPhrase(tempPhrase);<br>				s.addPart(p);<br>			} </span> </pre> 
                </td>
              </tr>
            </tbody>
          </table>
          
      <br>
      The next part of the </span><span
 class="code">main()</span> method makes lots of copies of the melody and positions 
      them a little bit later in time, creating a cannon affect.</span> <br>
      A for-loop is set up to go around 9 times.</span> 
      <p>A new Part object is created called 'p' 
            and given the name 'inst 1', its instrument is set to the general 
            MIDI number for XYLOPHONE, and the channel is set to the current value 
            of i (the first time around that will be zero, then one, then two, 
            and so on).</span></p>
          <p>Next and new Phrase object is declared, 
            called 'tempPhrase'. Then the start time of that phrase is set to 
            a new value (the copy function would mean that it originally had the 
            same start time of the phrase 'phr' from which it is a copy.) The 
            math to calculate the new start time uses the variable i which changes 
            each time around the for-loop ensuring that each time the copied phrase 
            has a different start time.</span></p>
          <p>The Part 'p' then adds the Phrase 'tempPhrase' 
            to itself.</span></p>
          <p>The score 's' then adds the part 'p' to 
            itself by calling its </span><span class="code">addPart()</span>method.</span></p>
          <p> 
          <table border="0" width="100%" bgcolor="#e0e0e0">
            <tbody>
              <tr> 
                <td> <pre> <span class="code">	</span> public static void main(String[] args) { </span> <span class="comment">  <br>		// repeat the whole compositional process several times </span> <br>		 </span> for(int j=0;j&lt;10;j++){  <br>		 </span></font> <span class="comment">  <br>			// create a score to hold the composition </span> <br>			Score s = new Score("Follow Music Demo "+j);<br>			 </span> <span class="comment">  <br>			// create a phrase to hold the melody </span> <br>			Phrase phr = new Phrase(0.0);<br>			 </span> <span class="comment">  <br>			// create a random walk melody </span> <br>			 </span><font color="#af0000"> int pitch = C4;<br>			for(int i=0;i&lt;60;i++){<br>				Note n = new Note(pitch,0.5, (int)(Math.random()*127));<br>				phr.addNote(n);<br>				pitch += (int)(Math.random()*10-5);<br>			} </font> <br>			 </span> <span class="comment">  <br>			// copy and repeat the melody numerous times </span> <br>			 </span><span size="+1" face="Courier"
 color="#0000af"> for(int i=0;i&lt;9;i++){<br>				Part p = new Part("inst 1", XYLOPHONE, i);<br>				Phrase tempPhrase = new Phrase();<br>				tempPhrase = phr.copy();<br>				tempPhrase.setStartTime((double)i/4.0+i*2);<br>				p.addPhrase(tempPhrase);<br>				s.addPart(p);<br>			} </font></span> <br>			 </span> <span class="comment">  <br>			// save a MIDI file of the result </span> <br>			Write.midi(s, "FollowMusic"+j+".mid");<br>			 </span> <span class="comment">  <br>			// display a visual score of the result </span> <br>			View.show(s, j*10, j*20);<br>		 </span> }  <br>	} </span></font> </pre>  
                  </font></font></td>
              </tr>
            </tbody>
          </table>
          
      <br>
      This code segment shows all of the main() method. <br>
      The melody creation code we saw above is marked in red and the phrase copying 
      and shifting code is marked in blue.</span> 
      <p></p>
          <p>Toward the top of the main() method is 
            a for-loop (coloured yellow) that encases the whole compositional 
            process. Thus repeating the composition 10 times. The variable 'j' 
            is used as a counter.</span></p>
          <p>This variable 'j' turns up in the Write.midi() 
            line as part of the file name. </span><span class="code">"FollowMusic"+j+".mid"</span> This results in file names such as FollowMusic0.mid and 
            FollowMusic1.mid and so on, as the value of 'j' changes each time 
            through the loop. This is a useful technique for creating many similar 
            files in the one go.</span></p>
          <p>Likewise, the variable 'j' is used in the 
            View.show line to set the position at which the showScore window will 
            appear on the screen. This results in a offset-stacking of the windows 
            for neat appearance.</span> </p>
          <p>Try modifying the class to produce longer 
            melodies with fewer or more copies. You might like to change the instrument 
            for each copy as a challenge.</span> </p>
          <h2>&nbsp;</h2>
        </div>
        </div>
      </td>
    <!-- InstanceEndEditable --></tr>
  <tr> 
    <td align="left"> <div align="left"></div></td>
  </tr>
  <tr> 
    <td align="left">&nbsp;</td>
  </tr>
</table>
<blockquote> 
  <p name="Map"> 
    <map name="Map">
      <area shape="rect" coords="4,4,41,29" href="http://jmusic.ci.qut.edu" target="_blank" alt="jMusic">
      <area shape="rect" coords="43,5,80,31" href="http://www.ozco.gov.au" target="_blank" alt="Australia Council">
      <area shape="rect" coords="83,4,108,29" href="http://www.qut.com" target="_blank" alt="Queensland University of Technology">
    </map>
    <map name="Map2">
      <area shape="rect" coords="702,1,758,12" href="../../extras/sitemap.html" target="_self" alt="Sitemap">
      <area shape="rect" coords="629,1,687,12" href="../../extras/contact.html" target="_self" alt="Contact">
      <area shape="rect" coords="574,1,615,14" href="../../index.html" target="_self" alt="Home">
    </map>
    <map name="Map3">
      <area shape="rect" coords="553,5,601,18" href="#" alt="Home">
      <area shape="rect" coords="612,4,671,18" href="#">
      <area shape="rect" coords="683,3,735,19" href="#">
      <area shape="rect" coords="9,8,227,59" href="#" target="index.html">
    </map>
    <map name="Map4">
      <area shape="rect" coords="6,9,40,41" href="http://www.qut.com" target="_blank" alt="http://www.qut.com">
      <area shape="rect" coords="44,14,87,42" href="http://explodingart.com/jmusic" target="_blank" alt="http://explodingart.com/jmusic">
      <area shape="rect" coords="90,9,138,43" href="http://www.ozco.gov.au" target="_parent" alt="http://www.ozco.gov.au">
      <area shape="rect" coords="313,13,512,36" href="../../contact.html">
    </map>
  </p>
</blockquote>
<map name="Map5">
  <area shape="rect" coords="-7,4,228,51" href="../../index.htm" target="_self" alt="Digital Instrument making">
  <area shape="rect" coords="599,1,658,18" href="../../index.htm" alt="Home">
  <area shape="rect" coords="677,3,755,18" href="../../extras/contact.htm" target="extras">
</map>
</body>
<!-- InstanceEnd --></html>
