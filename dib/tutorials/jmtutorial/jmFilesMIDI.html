<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/tutorial files.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" -->
<title>Digital Instrument Building</title>
<!-- InstanceEndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="DC.Creator" CONTENT="PersonalName= Andrew R. Brown  ">
<META NAME="DC.Creator.Email" CONTENT="algorithmicmusic@gmail.com,">
<META NAME="DC.Rights" CONTENT="Andrew R. Brown ">
<META NAME="DC.Title" CONTENT="Digital Instrument Building - Music software development with jMusic">
<META NAME="DC.Title.Alternative" content ="Music software development with jMusic">
<META NAME="DC.Subject" CONTENT="music, java, composition, algorithmic, digital music, generative music, instrument building, music analysing software development, Australia">
<META NAME="DC.Description" CONTENT="This site is a tutorial resource designed to assist in the training and self education of up-and-coming digital instrument developers. The tutorials cover topics including music software design, audio synthesis, digital signal processing, compositional systems, and computer programming concepts. ">
<META NAME="DC.Language" SCHEME="rfc1766" CONTENT="en-au">
<META NAME="DC.Audience" CONTENT="All">
<META NAME="DC.Date.Created" CONTENT="06-04-2003">
<META NAME="DC.Availability" CONTENT="PersonalName= Andrew R. Brown; email= algorithmicmusic@gmail.com">
<!-- ImageReady Preload Script (menubanner2.psd) -->
<SCRIPT TYPE="text/javascript">
<!--

function newImage(arg) {
	if (document.images) {
		rslt = new Image();
		rslt.src = arg;
		return rslt;
	}
}

function changeImages() {
	if (document.images && (preloadFlag == true)) {
		for (var i=0; i<changeImages.arguments.length; i+=2) {
			document[changeImages.arguments[i]].src = changeImages.arguments[i+1];
		}
	}
}

var preloadFlag = false;
function preloadImages() {
	if (document.images) {
		Music_algorithms_over = newImage("images/Music-algorithms-over.jpg");
		Interfaces_over = newImage("images/Interfaces-over.jpg");
		Programming_over = newImage("images/Programming-over.jpg");
		Acoustics_over = newImage("images/Acoustics-over.jpg");
		context_over = newImage("images/context-over.jpg");
		audio_over = newImage("images/audio-over.jpg");
		MIDI_over = newImage("images/MIDI-over.jpg");
		preloadFlag = true;
	}
}

// -->
</SCRIPT>
<!-- End Preload Script -->
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
//-->
</script>
<script language="JavaScript" type="text/JavaScript">
<!--


function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);

function MM_nbGroup(event, grpName) { //v6.0
  var i,img,nbArr,args=MM_nbGroup.arguments;
  if (event == "init" && args.length > 2) {
    if ((img = MM_findObj(args[2])) != null && !img.MM_init) {
      img.MM_init = true; img.MM_up = args[3]; img.MM_dn = img.src;
      if ((nbArr = document[grpName]) == null) nbArr = document[grpName] = new Array();
      nbArr[nbArr.length] = img;
      for (i=4; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
        if (!img.MM_up) img.MM_up = img.src;
        img.src = img.MM_dn = args[i+1];
        nbArr[nbArr.length] = img;
    } }
  } else if (event == "over") {
    document.MM_nbOver = nbArr = new Array();
    for (i=1; i < args.length-1; i+=3) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = (img.MM_dn && args[i+2]) ? args[i+2] : ((args[i+1])? args[i+1] : img.MM_up);
      nbArr[nbArr.length] = img;
    }
  } else if (event == "out" ) {
    for (i=0; i < document.MM_nbOver.length; i++) {
      img = document.MM_nbOver[i]; img.src = (img.MM_dn) ? img.MM_dn : img.MM_up; }
  } else if (event == "down") {
    nbArr = document[grpName];
    if (nbArr)
      for (i=0; i < nbArr.length; i++) { img=nbArr[i]; img.src = img.MM_up; img.MM_dn = 0; }
    document[grpName] = nbArr = new Array();
    for (i=2; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = img.MM_dn = (args[i+1])? args[i+1] : img.MM_up;
      nbArr[nbArr.length] = img;
  } }
}
//-->
</script>
<link href="../../style/main.css" rel="stylesheet" type="text/css">
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
</head>
<body leftmargin="3" topmargin="3" marginwidth="0" marginheight="0"  onLoad="MM_preloadImages('../../images/banner/audio-over.jpg','../../images/banner/MIDI-over.jpg','../../images/banner/Music-algorithms-over.jpg','../../images/banner/Interfaces-over.jpg','../../images/banner/Programming-over.jpg','../../images/banner/Acoustics-over.jpg','../../images/banner/context-over.jpg','../../images/banner/banner_08.gif')">
<table width="691" border="0" align="center">
  <tr> 
    <td colspan="5" align="left"> <div align="center"> 
        <table border="0" align="left" cellpadding="0" cellspacing="0">
          <tr> 
            <td colspan="8"><img src="../../images/banner.jpg" alt="" width=758 height=57 border="0" usemap="#Map5"></td>
          </tr>
          <tr> 
            <td width="50"><a href="../../Audio/audio.htm" target="_top" onClick="MM_nbGroup('down','group1','Audio','../../images/banner/audio-over.jpg',1)" onMouseOver="MM_nbGroup('over','Audio','../../images/banner/audio-over.jpg','../../images/banner/audio-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/audio.jpg" alt="audio" name="Audio" width="50" height="24" border="0" onload=""></a></td>
            <td width="47"><a href="../../midi/midi.htm" target="_top" onClick="MM_nbGroup('down','group1','MIDI','../../images/banner/MIDI-over.jpg',1)" onMouseOver="MM_nbGroup('over','MIDI','../../images/banner/MIDI-over.jpg','../../images/banner/MIDI-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/MIDI.jpg" alt="MIDI" name="MIDI" width="47" height="24" border="0" onload=""></a></td>
            <td width="117"><a href="../../musalgo/musalgo.htm" target="_top" onClick="MM_nbGroup('down','group1','musalgorithms','../../images/banner/Music-algorithms-over.jpg',1)" onMouseOver="MM_nbGroup('over','musalgorithms','../../images/banner/Music-algorithms-over.jpg','../../images/banner/Music-algorithms-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Music-algorithms.jpg" alt="Music Algorithms" name="musalgorithms" width="117" height="24" border="0" onload=""></a></td>
            <td width="88"><a href="../../interfaces/interface.htm" target="_top" onClick="MM_nbGroup('down','group1','Interfaces','../../images/banner/Interfaces-over.jpg',1)" onMouseOver="MM_nbGroup('over','Interfaces','../../images/banner/Interfaces-over.jpg','../../images/banner/Interfaces-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Interfaces.jpg" alt="Interfaces" name="Interfaces" width="88" height="24" border="0" onload=""></a></td>
            <td width="103"><a href="../../programming/programming.htm" target="_top" onClick="MM_nbGroup('down','group1','Programming','../../images/banner/Programming-over.jpg',1)" onMouseOver="MM_nbGroup('over','Programming','../../images/banner/Programming-over.jpg','../../images/banner/Programming-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Programming.jpg" alt="Programming" name="Programming" width="103" height="24" border="0" onload=""></a></td>
            <td width="81"><a href="../../acoustics/acoustics.htm" target="_top" onClick="MM_nbGroup('down','group1','Acoustics','../../images/banner/Acoustics-over.jpg',1)" onMouseOver="MM_nbGroup('over','Acoustics','../../images/banner/Acoustics-over.jpg','../../images/banner/Acoustics-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/Acoustics.jpg" alt="Acoustics" name="Acoustics" width="81" height="24" border="0" onload=""></a></td>
            <td width="100"><a href="../../context/context.htm" target="_top" onClick="MM_nbGroup('down','group1','Context','../../images/banner/context-over.jpg',1)" onMouseOver="MM_nbGroup('over','Context','../../images/banner/context-over.jpg','../../images/banner/context-over.jpg',1)" onMouseOut="MM_nbGroup('out')"><img src="../../images/banner/context.jpg" alt="Context" name="Context" width="100" height="24" border="0" onload=""></a></td>
            <td width="156"><img src="../../images/banner/banner_09.gif" width="172" height="24"></td>
          </tr>
        </table>
      </div></td>
  </tr>
  <tr> 
    <td width="3" align="left"> <div align="right"></div>
      <div align="right"></div>
      <div align="right"></div></td>
    <!-- InstanceBeginEditable name="tracker" -->
    <td height="16" colspan="2" rowspan="2" align="left"><a href="../../midi/midi.htm">&gt; 
      MIDI </a>&gt;<a href="../../midi/in_out.htm"> Input / Output</a> &gt; <a href="jmFilesMIDI.html">Reading 
      and modifying .jm files</a></td>
    <!-- InstanceEndEditable -->
    <td width="15" rowspan="2" align="left">&nbsp;</td>
    <td width="214" rowspan="2" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="3" rowspan="3" align="left">&nbsp;</td>
  </tr>
  <tr> 
    <td width="66" align="left" valign="top">&nbsp;</td>
    <td width="444" align="left" valign="top">&nbsp;</td>
    <td colspan="2" align="left" valign="top"><strong></strong></td>
  </tr>
  <tr> <!-- InstanceBeginEditable name="content" --> 
    <td colspan="4" rowspan="3" align="left" valign="top"> 
      <h2 >Reading 
        and modifying .jm files</h2>
      <p>jMusic has the ability to save scores in its own file format, by convention 
        written with the suffix '.jm'.<br>
        This format may not seem very useful, but in this tutorial we'll see how 
        to read in an existing jm file then make further changes to it.<br>
        A jm file keeps all jMusic data attributes ( a MIDI file does not) such 
        as the phrase structure, difference between rhythmic value and duration, 
        and so on. . . The reading of jm files also means than a composition can 
        use existing material from one section for further development in another 
        section.<br>
      </p>
      <p>There are three files in this tutorial. The first one generates a jm 
        score and saves it to disk.<br>
        The second reads back that file, modifies it, and resaves it to disk as 
        a second jm file. <br>
        The third file writes and reads each of the score, a part, and a phrase, 
        within the one file as an exercise.</p>
      <p><a
 href="../jmdemos/JmGenerate.java" target="_self">Click here to view source of 
        JmGenerate.java</a> </p>
      <p><a
 href="../jmdemos/JmMod.java" target="_self">Click here to view source of JmMod.java</a> 
      </p>
      <p><a
 href="../jmdemos/JmGenerateTest.java"
 target="_self">Click here to view source of JmGenerateTest.java</a></p>
      <p>Lets have a closer look at the important bit only. By now you should 
        be well versed in the jMusic basics : ). 
      <p>&nbsp; 
      <table width="100%" height="31" border="0" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td height="14"> 
              <pre>Write.jm(score, "generate.jm");</pre> </td>
          </tr>
        </tbody>
      </table>
      <br>
      <br>
      The generate class simply creates a score of two parts with one phrase each.<br>
      Each phrase has randomly distributed notes.<br>
      The above line of code above saves the score as a file to disk with the 
      name 'generate.jm' <br>
      The importing of the jm.util package is necessary to use the Read and Write 
      classes.
<p> 
      <table border="0" width="100%" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td> <pre>import jm.JMC;<br>import jm.music.data.*;<br>import jm.midi.*;<br>import jm.music.tools.*;<br>import jm.util.*;<br>&nbsp;<br><span class="comment">/**<br> * An example which reads in, accesses,  and then modifies an <br> * existing jm score file<br> * @author Andrew R. Brown and Alistair Riddel<br> */</span><br> public final class JmMod implements JMC{<br>&nbsp;<br>	public static void main(String[] args){<br>		Score score = new Score("JMDemo - Modify a jm file");<br>		Part inst = new Part("Flute", FLUTE, 0); <br>		Part inst2 = new Part("Piano", PIANO, 1);<br>		Phrase phr = new Phrase(0.0);<br>		Phrase phr2 = new Phrase(0.0);<br>&nbsp;<br>		/<span class="comment">/read in the jm file to be modified</span><br>		Read.jm(score, "generate.jm");<br>		<br>		/<span class="comment">/extract out the score bits to work on</span><br>		inst = score.getPart(0);<br>		inst2 = score.getPart(1);<br>     		phr = inst.getPhrase(0);<br>	     	phr2 = inst2.getPhrase(0);<br>		<br>		/<span class="comment">/make the modification</span><br>		/<span class="comment">/make the phrases sequential rather than simultaneous</span><br>		phr2.setStartTime(phr.getEndTime());<br>		<br>		/<span class="comment">/Show the result</span><br>     		View.show(score);<br>&nbsp;<br>		<span class="comment">//write a JM Score file to disk</span><br>		Write.jm(score, "generateMod.jm");	<br>&nbsp;<br>		<span class="comment">//write a MIDI file to disk of the result</span><br>		Write.midi(score, "generateMod.mid");<br>	}	<br>}</pre> </td>
          </tr>
        </tbody>
      </table>
      This code fragment is from the JmMod.java file. 
      The first line reads in the jm file created by the previous class. It then 
      accesses the parts and phrases within it using the getPart() and getPhrase() 
      methods. These methods take a number as an argument which is the nth element 
      of that type. <p></p>
      <p>The final line makes a modification to the 
        second phrase by changing its start time. It gets the length of the first 
        phrase and uses that as its start time. Thereby making the two phrases 
        follow one after the other in time.</p>
      <p> 
      <table border="0" width="100%" bgcolor="#e0e0e0">
        <tbody>
          <tr> 
            <td> <pre>import jm.JMC;<br>import jm.music.data.*;<br>import jm.midi.*;<br>import jm.music.tools.*;<br>import jm.util.*;<br>&nbsp;<br><span class="comment">/**<br> * An example which generates the writing of two phrases<br> * and saving as a jm file.<br> * For use with JmMod.java which edits the jm file<br> * @author Andrew R. Brown and Alistair Riddel<br> */</span><br> public final class JmGenerateTest implements JMC{<br>	public static void main(String[] args){<br>		Score score = new Score("JMDemo - jm Generate test");<br>		Part part1 = new Part("part 1", 1, 0); <br>		Part part2 = new Part("part 2", 1, 1); <br>		Phrase phr = new Phrase(0.0);<br>		Phrase phr2 = new Phrase(0.0);<br>	<br>		double beat = Math.random() * 1.0;<br>		phr = note_density(beat);<br>		beat = Math.random() * 1.0;<br>		phr2 = note_density(beat);<br>				<br>		part1.addPhrase(phr);<br>		part2.addPhrase(phr2);<br>		score.addPart(part1);<br>		score.addPart(part2);<br>		<br>		/<span class="comment">/ view the result</span><br>		View.show(score);<br><br>		/<span class="comment">/write a MIDI file to disk</span><br>		Write.midi(score, "generateTest.mid");<br>		<br>		<span class="comment">//save as a jm file to disk</span><br>		Write.jm(score, "generateTest.jm");<br>		<span class="comment">//save the part to disk</span><br>		Write.jm(part1, "generateTest.prt");<br>		/<span class="comment">/save the phrase to disk</span><br>		Write.jm(phr, "generateTest.phr");<br>		<br>		<span class="comment">//Create, or emty and refill.  View to show it's back</span><br>		Score scoreCopy = new Score();<br>		Read.jm(scoreCopy, "generateTest.jm");<br>		scoreCopy.setTitle("Score Copy");<br>		View.show(scoreCopy, 10, 10);<br>		<br>		part1.empty();<br>		Read.jm(part1, "generateTest.prt");<br>		View.show(part1, 20, 20);<br>		<br>		phr.empty();<br>		Read.jm(phr, "generateTest.phr");<br>		View.show(phr, 40, 40);<br><br>		System.out.println("Done!");<br>	}<br>	<br><br>	private static Phrase note_density(double beat) {<br>	 	Phrase phrase = new Phrase();<br> 		int cnt;<br> 		int dyn = 100;<br> 		long dur = 350;<br> 		int pitch;<br>			<br>		cnt = (int)(Math.random() * 100);<br>    		System.out.println(cnt);<br>			<br>		for(short i=0;i&lt;cnt;i++){<br>			pitch = (int)(Math.random() * 127);<br>			Note note = new Note(pitch, beat, dyn, dur);<br>			phrase.addNote(note);<br>		}<br>		return phrase;<br>	 }	<br>}</pre> </td>
          </tr>
        </tbody>
      </table>
      This code fragment is from the third class of this example, the JmGenerateTest.java 
      class.<br>
      After generating the score in the same way as above, this class writes the 
      score, the first part, and the first phrase to disk. <br>
      Following this a new score object is declared and the jm file read into 
      it. <br>
      The part and phrase objects previously used are emptied in turn and the 
      appropriate files read into them.<br>
      Each of the old and new scores, part, and phrase is displayed in a pseudo 
      notation window so you can compare the outputs and see the results. 
     
    
        </td>
    <!-- InstanceEndEditable --></tr>
  <tr> 
    <td align="left"> <div align="left"></div></td>
  </tr>
  <tr> 
    <td align="left">&nbsp;</td>
  </tr>
</table>
<blockquote> 
  <p name="Map"> 
    <map name="Map">
      <area shape="rect" coords="4,4,41,29" href="http://jmusic.ci.qut.edu" target="_blank" alt="jMusic">
      <area shape="rect" coords="43,5,80,31" href="http://www.ozco.gov.au" target="_blank" alt="Australia Council">
      <area shape="rect" coords="83,4,108,29" href="http://www.qut.com" target="_blank" alt="Queensland University of Technology">
    </map>
    <map name="Map2">
      <area shape="rect" coords="702,1,758,12" href="../../extras/sitemap.html" target="_self" alt="Sitemap">
      <area shape="rect" coords="629,1,687,12" href="../../extras/contact.html" target="_self" alt="Contact">
      <area shape="rect" coords="574,1,615,14" href="../../index.html" target="_self" alt="Home">
    </map>
    <map name="Map3">
      <area shape="rect" coords="553,5,601,18" href="#" alt="Home">
      <area shape="rect" coords="612,4,671,18" href="#">
      <area shape="rect" coords="683,3,735,19" href="#">
      <area shape="rect" coords="9,8,227,59" href="#" target="index.html">
    </map>
    <map name="Map4">
      <area shape="rect" coords="6,9,40,41" href="http://www.qut.com" target="_blank" alt="http://www.qut.com">
      <area shape="rect" coords="44,14,87,42" href="http://explodingart.com/jmusic" target="_blank" alt="http://explodingart.com/jmusic">
      <area shape="rect" coords="90,9,138,43" href="http://www.ozco.gov.au" target="_parent" alt="http://www.ozco.gov.au">
      <area shape="rect" coords="313,13,512,36" href="../../contact.html">
    </map>
  </p>
</blockquote>
<map name="Map5">
  <area shape="rect" coords="-7,4,228,51" href="../../index.htm" target="_self" alt="Digital Instrument making">
  <area shape="rect" coords="599,1,658,18" href="../../index.htm" alt="Home">
  <area shape="rect" coords="677,3,755,18" href="../../extras/contact.htm" target="extras">
</map>
</body>
<!-- InstanceEnd --></html>
